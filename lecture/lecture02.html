<!DOCTYPE html>
<html>
  <head>
    <title>USP654: Data Analysis II</title>
    <meta charset="utf-8">
    <meta name="author" content="Liming Wang" />
    <meta name="date" content="2017-10-02" />
    <link rel="stylesheet" href="example.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# USP654: Data Analysis II
## Bivariate Regression
### Liming Wang
### October 02, 2017

---




# Outline

- Why Regression Analysis?
- Bivariate Regression
   - Interpretation of regression coefficients
   - Ordinary Least Squares Estimation
   - Hypothesis testing of coefficients
   - Confidence interval of coefficients
   - Standardized regression

---

# Why Regression Analysis?

- Regression analysis allows scientists to quantify how the average of one variable systematically varies according to the levels of another variable;
- Comparing with hypothesis testing techinque we reviewed before, additional variables can be introduced into regression models to help to determine if a relationship is genuine or spurious;
- Regression models also allow scientists to examine the mechanisms that their theories and ideas suggest explain the association between a particular predictor variable and an outcome;
- Regression models can be used to examine how two predictors jointly associate with an outcome variable;
- Regression models can be used for predictions or scenario analysis.

---

# Why Regression Analysis - An Example

[Eng, Sothy. 2012. “Cambodian Early Adolescents’ Academic Achievement: The Role of Social Capital.” Journal of Early Adolescence 33(3): 378–403.](http://journals.sagepub.com/doi/pdf/10.1177/0272431612441069)

---

# Scatter plot &amp; regression line

&lt;img src="lecture02_files/figure-html/unnamed-chunk-1-1.png" width="672" /&gt;

---

# Correlation


```r
cor(mtcars$hp, mtcars$carb)
```

```
## [1] 0.7498125
```

```r
cor(mtcars$hp, mtcars$carb)^2
```

```
## [1] 0.5622187
```

---

# Interpretation of Regression Coefficients

![betas](img/fig_interpret_betas.png)

---

# Regression Equations

Population regression line

`$$\text{Y}_i = \beta_0 + \beta_1 \text{X}_i + \epsilon_i$$`
`$$\text{HP}_i = \beta_0 + \beta_1 \text{carb}_i + \epsilon_i$$`
Sample regression model

`$${\text{Y}}_i = \hat{\beta}_0 + \hat{\beta}_1 \text{X}_i + \epsilon_i$$`

`$${\text{HP}}_i = \hat{\beta}_0 + \hat{\beta}_1 \text{carb}_i + \epsilon_i$$`

---

# Conditional distributions

![Conditional distributions](img/fig_regline_dist.png)

---

# Ordinary Least Squares (OLS) Estimators

![error plot](img/fig_sse_plot.png)

---

# Ordinary Least Squares (OLS) Estimators

![error eq](img/fig_sse_eq.png)

---

# Ordinary Least Squares (OLS) Estimators

![OLS estimator](img/fig_beta_point_est.png)

---

# Assumptions of OLS 

**I**dentically **I**ndependently Normal **D**istributed (or iid Normal) error term `\(\epsilon_i\)` :
`$$\epsilon_i \sim N(0, \sigma^2)$$`
`$$Y_i|X_i \sim N(\beta_0 + \beta_1 X_i, \sigma^2)$$`

Will come back to checking of OLS assumptions later.

---

# Hypothesis Testing

1. List the null and alternative hypotheses about the value that you expect for the parameter being estimated (in regression models, typically the slope).
2. Calculate a test statistic (typically, the point estimate of the parameter minus the hypothesized value, divided by the estimated standard error).
3. Determine the critical value given the test statistic’s distribution (e.g., Z- or t-distribution) and a pre-specified alpha level (typically 0.05).
4. Reject the null hypothesis if the magnitude of the calculated test statistic is larger than the critical value or the corresponding p-value is lower than the pre-specified alpha.

---

# Hypothesis Testing about OLS Coefficients

`$$\beta_1 \sim t_{df}(\hat{\beta}_1, \hat{\sigma}_{\hat{\beta}_1})$$`
`$$H_o: \beta_1 = \beta^*_1$$`
`$$H_a: \beta_1 \neq \beta^*_1$$`

---

# Hypothesis Testing about OLS Coefficients


```r
library(tidyverse)
lm(hp ~ carb, data=mtcars) %&gt;% summary()
```

```
## 
## Call:
## lm(formula = hp ~ carb, data = mtcars)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -74.48 -26.83  12.00  29.17  79.52 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   57.170     16.566   3.451  0.00168 ** 
## carb          31.828      5.128   6.207 7.83e-07 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 46.11 on 30 degrees of freedom
## Multiple R-squared:  0.5622,	Adjusted R-squared:  0.5476 
## F-statistic: 38.53 on 1 and 30 DF,  p-value: 7.828e-07
```

---

# Confience intervals for OLS coefficients


```r
lm(hp ~ carb, data=mtcars) %&gt;% 
  confint()
```

```
##                2.5 %   97.5 %
## (Intercept) 23.33686 91.00318
## carb        21.35608 42.30079
```

---

# Standardized coefficients

```r
install.packages("lm.beta"); library(lm.beta)
lm(hp ~ carb, data=mtcars) %&gt;% 
  lm.beta() %&gt;% 
  summary()
```

```
## 
## Call:
## lm(formula = hp ~ carb, data = mtcars)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -74.48 -26.83  12.00  29.17  79.52 
## 
## Coefficients:
##             Estimate Standardized Std. Error t value Pr(&gt;|t|)    
## (Intercept)  57.1700       0.0000    16.5664   3.451  0.00168 ** 
## carb         31.8284       0.7498     5.1278   6.207 7.83e-07 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 46.11 on 30 degrees of freedom
## Multiple R-squared:  0.5622,	Adjusted R-squared:  0.5476 
## F-statistic: 38.53 on 1 and 30 DF,  p-value: 7.828e-07
```
    </textarea>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {window.dispatchEvent(new Event('resize'));});
(function() {var d = document, s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler"); if (!r) return; s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }"; d.head.appendChild(s);})();</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre']
  }
});
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
